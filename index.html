<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mind HQ - Antimatter</title>
    <style>
        :root {
            --bg: #020617;
            --vessel: #22d3ee;
            --entry: #00ffff;
            --reception: #d8b4fe;
            --mgmt: #4ade80;
            --workers: #f87171;
            --text: #f8fafc;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* The Vessel Container */
        #stage {
            flex: 1;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1000px;
        }

        svg#vessel {
            width: 90%;
            height: 90%;
            filter: drop-shadow(0 0 15px rgba(34, 211, 238, 0.4));
        }

        .outline { stroke: var(--vessel); stroke-width: 1.5; fill: none; opacity: 0.6; }
        .neural-path { stroke: var(--vessel); stroke-width: 0.5; opacity: 0.2; stroke-dasharray: 4; }

        /* Nodes & Brain Logic */
        .brain-ui { transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); transform-origin: 100px 60px; }
        .expanded .brain-ui { transform: translate(50px, -20px) scale(1.3); }

        .node { cursor: pointer; filter: drop-shadow(0 0 8px currentColor); }
        .node circle { transition: r 0.3s ease; }
        .node:hover circle { r: 12; }

        /* Worker Hotspots */
        .hotspot { fill: rgba(248, 113, 113, 0.2); stroke: var(--workers); stroke-width: 1; cursor: pointer; }
        .hotspot.active { animation: pulse 1.5s infinite; fill: rgba(248, 113, 113, 0.6); }

        @keyframes pulse {
            0% { r: 5; opacity: 1; }
            100% { r: 15; opacity: 0; }
        }

        /* UI Overlays */
        .modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.85);
            display: none; align-items: center; justify-content: center; z-index: 100;
        }
        .modal-box {
            background: #1e293b; width: 85%; padding: 25px; border-radius: 20px;
            border: 1px solid var(--vessel);
        }
        textarea {
            width: 100%; height: 100px; background: #0f172a; border: 1px solid #334155;
            color: white; border-radius: 10px; padding: 10px; margin-top: 15px; font-size: 16px;
        }
        .btn {
            width: 100%; padding: 12px; border-radius: 10px; border: none; font-weight: bold;
            margin-top: 10px; cursor: pointer;
        }
        .btn-save { background: var(--vessel); color: #020617; }

        nav {
            display: flex; justify-content: space-around; background: #0f172a; padding: 15px;
            border-top: 1px solid #1e293b;
        }
        .nav-tab { color: #64748b; font-size: 12px; font-weight: bold; text-decoration: none; }
        .nav-tab.active { color: var(--vessel); }

        #audit-view, #archive-view {
            display: none; position: absolute; inset: 0; background: var(--bg);
            z-index: 50; padding: 20px; overflow-y: auto;
        }
    </style>
</head>
<body>

    <header style="padding: 15px; text-align: center;">
        <h2 style="color: var(--vessel); letter-spacing: 2px; margin: 0;">MIND HQ</h2>
    </header>

    <div id="stage">
        <svg id="vessel" viewBox="0 0 200 400" onclick="handleStageClick(event)">
            <path class="outline" d="M100,20 C80,20 70,40 70,60 C70,85 85,95 85,100 L80,120 L50,140 L40,200 L55,200 L65,150 L85,155 L85,380 L115,380 L115,155 L135,150 L145,200 L160,200 L150,140 L120,120 L115,100 C115,95 130,85 130,60 C130,40 120,20 100,20 Z" />
            
            <path class="neural-path" d="M100,60 L100,150 M100,150 L60,140 M100,150 L140,140" />

            <g class="node" id="node-entry" onclick="openNode('Entry', 'entry', event)">
                <circle cx="128" cy="65" r="8" fill="var(--entry)" />
                <text x="138" y="68" fill="var(--entry)" font-size="8">ENTRY</text>
            </g>

            <g id="brain-group" class="brain-ui">
                <circle id="head-trigger" cx="100" cy="55" r="25" fill="transparent" onclick="toggleBrain(event)" />
                
                <g class="node" onclick="openNode('Reception', 'reception', event)">
                    <circle cx="100" cy="65" r="8" fill="var(--reception)" />
                </g>
                <g class="node" onclick="openNode('Management', 'mgmt', event)">
                    <circle cx="85" cy="50" r="8" fill="var(--mgmt)" />
                </g>
                <g class="node" onclick="openNode('Workers', 'workers', event)">
                    <circle cx="100" cy="35" r="8" fill="var(--workers)" />
                </g>
            </g>

            <circle class="hotspot" id="hs-heart" cx="100" cy="140" r="6" onclick="openNode('Worker-Heart', 'workers', event)" />
            <circle class="hotspot" id="hs-stomach" cx="100" cy="180" r="6" onclick="openNode('Worker-Gut', 'workers', event)" />
            <circle class="hotspot" id="hs-shoulders" cx="80" cy="120" r="5" onclick="openNode('Worker-Load', 'workers', event)" />
        </svg>

        <div id="modal" class="modal">
            <div class="modal-content modal-box">
                <h3 id="modal-title" style="margin: 0;"></h3>
                <p id="modal-sub" style="font-size: 12px; color: #94a3b8;"></p>
                <textarea id="node-input" placeholder="Observe the flow..."></textarea>
                <button class="btn btn-save" onclick="saveEntry()">LOG TO HQ</button>
                <button class="btn" style="background: none; color: #64748b;" onclick="closeModal()">CANCEL</button>
            </div>
        </div>

        <div id="audit-view">
            <button onclick="hideViews()" class="btn">Back to Blueprint</button>
            <div id="audit-list"></div>
        </div>
        <div id="archive-view">
            <button onclick="hideViews()" class="btn">Back to Blueprint</button>
            <h3>The Archive</h3>
            <textarea id="archive-input" placeholder="Personality, History, Empath triggers..."></textarea>
            <button class="btn btn-save" onclick="saveArchive()">UPDATE ARCHIVE</button>
        </div>
    </div>

    <nav>
        <a href="#" class="nav-tab active" onclick="hideViews()">BLUEPRINT</a>
        <a href="#" class="nav-tab" onclick="showView('archive')">ARCHIVE</a>
        <a href="#" class="nav-tab" onclick="showView('audit')">AUDIT</a>
    </nav>

    <script>
        let currentRoom = '';

        function toggleBrain(e) {
            e.stopPropagation();
            document.getElementById('brain-group').classList.toggle('expanded');
        }

        function openNode(room, colorVar, e) {
            e.stopPropagation();
            currentRoom = room;
            const modal = document.getElementById('modal');
            const title = document.getElementById('modal-title');
            const sub = document.getElementById('modal-sub');
            
            modal.style.display = 'flex';
            title.innerText = room.toUpperCase();
            title.style.color = `var(--${colorVar})`;
            
            if(room === 'Reception') sub.innerText = "John: Is this a Fact or an Archive Opinion?";
            else sub.innerText = "Triage the sensory data below.";
        }

        function closeModal() { document.getElementById('modal').style.display = 'none'; }

        function saveEntry() {
            const text = document.getElementById('node-input').value;
            if(!text) return;
            const logs = JSON.parse(localStorage.getItem('hq_logs') || '[]');
            logs.unshift({ room: currentRoom, text, time: new Date().toLocaleString() });
            localStorage.setItem('hq_logs', JSON.stringify(logs));
            closeModal();
            document.getElementById('node-input').value = '';
        }

        function showView(id) {
            document.getElementById(id + '-view').style.display = 'block';
            if(id === 'audit') renderAudit();
            if(id === 'archive') document.getElementById('archive-input').value = localStorage.getItem('hq_arch') || '';
        }

        function hideViews() {
            document.getElementById('audit-view').style.display = 'none';
            document.getElementById('archive-view').style.display = 'none';
        }

        function renderAudit() {
            const list = document.getElementById('audit-list');
            const logs = JSON.parse(localStorage.getItem('hq_logs') || '[]');
            list.innerHTML = logs.map(l => `
                <div style="background:#1e293b; padding:15px; margin-top:10px; border-radius:10px; border-left:3px solid var(--vessel);">
                    <div style="font-size:10px; color:var(--vessel);">${l.time} | ${l.room}</div>
                    <div style="margin-top:5px;">${l.text}</div>
                </div>
            `).join('');
        }

        function saveArchive() {
            localStorage.setItem('hq_arch', document.getElementById('archive-input').value);
            alert("Archive updated.");
        }
        
        function handleStageClick(e) {
            // Closes expanded brain if clicking empty stage space
            document.getElementById('brain-group').classList.remove('expanded');
        }
    </script>
</body>
</html>
