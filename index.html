<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mind HQ | Neural Interface</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;400;600&display=swap');

        :root {
            --bg-dark: #020617;
            --bg-card: #0f172a;
            --cyan: #22d3ee;
            --purple: #a855f7;
            --green: #10b981;
            --red: #f43f5e;
            --text: #f1f5f9;
            --text-dim: #64748b;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-dark);
            color: var(--text);
            font-family: 'Inter', sans-serif;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        h1 { font-family: 'Orbitron', sans-serif; font-size: 1.2rem; color: var(--cyan); letter-spacing: 2px; }

        /* Navigation */
        nav {
            position: fixed;
            bottom: 0;
            width: 100%;
            height: 75px;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            color: var(--text-dim);
            font-size: 10px;
            cursor: pointer;
            transition: 0.3s;
            background: none;
            border: none;
        }

        .nav-item.active { color: var(--cyan); }
        .nav-item svg { width: 22px; height: 22px; }

        /* Main Viewport */
        main { flex: 1; position: relative; overflow-y: auto; padding: 20px; padding-bottom: 90px; }
        .screen { display: none; animation: fadeIn 0.4s ease-out; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Interface Layout */
        .interface-container {
            position: relative;
            width: 100%;
            height: 70vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: radial-gradient(circle, rgba(34, 211, 238, 0.05) 0%, transparent 70%);
        }

        /* The Brain Pop-out */
        #brain-map {
            position: absolute;
            top: 20px;
            right: 10px;
            width: 200px;
            height: 200px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid var(--cyan);
            border-radius: 20px;
            opacity: 0;
            transform: scale(0.8) translateX(20px);
            pointer-events: none;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 100;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
            padding: 10px;
        }

        #brain-map.active {
            opacity: 1;
            transform: scale(1) translateX(0);
            pointer-events: auto;
        }

        /* SVG Components */
        .body-silhouette {
            height: 100%;
            max-width: 100%;
        }

        .clickable-node {
            cursor: pointer;
            filter: drop-shadow(0 0 5px currentColor);
            transition: transform 0.2s;
        }

        .clickable-node:hover { transform: scale(1.2); }

        /* Specific node colors */
        .cyan { color: var(--cyan); fill: var(--cyan); }
        .purple { color: var(--purple); fill: var(--purple); }
        .green { color: var(--green); fill: var(--green); }
        .red { color: var(--red); fill: var(--red); }

        /* Labels */
        .node-label {
            font-family: 'Orbitron', sans-serif;
            font-size: 8px;
            fill: white;
            pointer-events: none;
            text-transform: uppercase;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.9);
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
            z-index: 2000;
        }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--cyan);
            border-radius: 20px;
            padding: 25px;
            width: 100%;
            max-width: 400px;
        }

        label { display: block; font-size: 10px; color: var(--cyan); margin: 15px 0 5px; text-transform: uppercase; letter-spacing: 1px; }
        input, textarea {
            width: 100%;
            background: #000;
            border: 1px solid rgba(255,255,255,0.1);
            color: #fff;
            padding: 12px;
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
        }

        .btn {
            width: 100%;
            padding: 15px;
            border-radius: 8px;
            border: none;
            font-family: 'Orbitron', sans-serif;
            font-weight: bold;
            margin-top: 15px;
            cursor: pointer;
        }

        .btn-save { background: var(--cyan); color: #000; }
        .btn-cancel { background: transparent; color: var(--text-dim); }

        /* Audit Card */
        .audit-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            border-left: 4px solid var(--cyan);
        }

        /* Triage Alert */
        #triage-alert {
            position: fixed;
            top: 20px; left: 20px; right: 20px;
            background: var(--purple);
            padding: 20px; border-radius: 15px;
            display: none; z-index: 3000;
            box-shadow: 0 10px 40px rgba(0,0,0,0.8);
        }
    </style>
</head>
<body>

    <div id="triage-alert">
        <h2 style="font-family: 'Orbitron'; font-size: 14px;">Archival Check Required</h2>
        <p id="alert-msg" style="margin: 10px 0; font-size: 14px;"></p>
        <button class="btn btn-save" style="padding: 10px; margin: 0;" onclick="closeAlert()">Confirm</button>
    </div>

    <main>
        <!-- MIND HQ -->
        <section id="screen-hq" class="screen active">
            <h1>Mind HQ</h1>
            <p style="font-size: 10px; color: var(--text-dim);">Tap Head to Expand Neural Nodes</p>

            <div class="interface-container">
                <!-- Expanded Brain View -->
                <div id="brain-map">
                    <h3 style="font-family: 'Orbitron'; font-size: 10px; color: var(--cyan); text-align: center; margin-bottom: 10px;">Brain Structure</h3>
                    <svg viewBox="0 0 120 120" width="100%" height="150">
                        <!-- Entry (By Ear Area) -->
                        <circle class="clickable-node cyan" cx="100" cy="70" r="8" onclick="openNode('Entry (External Trigger)')" />
                        <text x="100" y="85" class="node-label" text-anchor="middle">Entry</text>

                        <!-- Reception (Center) -->
                        <circle class="clickable-node purple" cx="60" cy="65" r="10" onclick="openNode('Reception (Core Belief)')" />
                        <text x="60" y="85" class="node-label" text-anchor="middle">Reception</text>

                        <!-- Management (Front) -->
                        <circle class="clickable-node green" cx="30" cy="60" r="8" onclick="openNode('Management (Rules)')" />
                        <text x="30" y="75" class="node-label" text-anchor="middle">Mgmt</text>

                        <!-- Workers (Top) -->
                        <circle class="clickable-node red" cx="60" cy="30" r="8" onclick="openNode('Workers (Unhelpful Behavior)')" />
                        <text x="60" y="20" class="node-label" text-anchor="middle">Workers</text>
                        
                        <!-- Connecting Path -->
                        <path d="M100,70 Q60,70 60,65 T30,60" fill="none" stroke="rgba(255,255,255,0.2)" stroke-dasharray="2" />
                    </svg>
                    <button class="btn-cancel" style="width:100%; font-size: 10px;" onclick="toggleBrain()">Close Brain Map</button>
                </div>

                <!-- Main Body Silhouette -->
                <svg class="body-silhouette" viewBox="0 0 200 500">
                    <!-- Head Area (Trigger) -->
                    <path id="head-sensor" d="M100,40 C80,40 70,55 70,80 C70,105 85,120 100,120 C115,120 130,105 130,80 C130,55 120,40 100,40" 
                          fill="rgba(34, 211, 238, 0.1)" stroke="var(--cyan)" stroke-width="1.5" style="cursor: pointer;" onclick="toggleBrain()"/>
                    <circle cx="100" cy="80" r="5" fill="var(--cyan)">
                        <animate attributeName="opacity" values="1;0.2;1" dur="2s" repeatCount="indefinite" />
                    </circle>

                    <!-- Anatomical Outline (Subtle) -->
                    <path d="M100,120 L100,135 M70,140 L130,140 M100,135 L60,150 L50,300 M100,135 L140,150 L150,300 M70,350 L70,480 M130,350 L130,480 M60,150 L60,350 L140,350 L140,150" 
                          fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1" />

                    <!-- BODY NODES ONLY: Hands, Heart, Gut, Legs -->
                    <!-- Heart -->
                    <circle class="clickable-node red" cx="100" cy="180" r="8" onclick="openNode('Heart (Emotion Center)')" />
                    <text x="112" y="184" class="node-label">Heart</text>

                    <!-- Gut -->
                    <circle class="clickable-node purple" cx="100" cy="280" r="8" onclick="openNode('Gut (Instinct)')" />
                    <text x="112" y="284" class="node-label">Gut</text>

                    <!-- Hands -->
                    <circle class="clickable-node cyan" cx="48" cy="300" r="7" onclick="openNode('Left Hand (Action)')" />
                    <circle class="clickable-node cyan" cx="152" cy="300" r="7" onclick="openNode('Right Hand (Action)')" />
                    <text x="48" y="320" class="node-label" text-anchor="middle">Action</text>
                    <text x="152" y="320" class="node-label" text-anchor="middle">Action</text>

                    <!-- Legs -->
                    <circle class="clickable-node green" cx="70" cy="420" r="7" onclick="openNode('Left Leg (Movement)')" />
                    <circle class="clickable-node green" cx="130" cy="420" r="7" onclick="openNode('Right Leg (Movement)')" />
                    <text x="100" y="440" class="node-label" text-anchor="middle">Legs/Stability</text>
                </svg>
            </div>
        </section>

        <!-- THE ARCHIVE -->
        <section id="screen-archive" class="screen">
            <h1>The Archive</h1>
            <label>Personality Traits</label>
            <textarea id="arc-traits" rows="3" placeholder="Core defining traits..."></textarea>
            
            <label>Historical Context</label>
            <textarea id="arc-history" rows="3" placeholder="Relevant past events..."></textarea>
            
            <label>Known Triggers</label>
            <textarea id="arc-triggers" rows="3" placeholder="External factors that spike system..."></textarea>
            
            <button class="btn btn-save" onclick="saveArchive()">Persist Archive</button>
        </section>

        <!-- WEEKLY AUDIT -->
        <section id="screen-audit" class="screen">
            <h1>Weekly Audit</h1>
            <div id="audit-list" style="margin-top:20px;"></div>
            <button class="btn btn-cancel" onclick="clearAudit()" style="border: 1px solid var(--red); color: var(--red); margin-top:30px;">Purge Audit History</button>
        </section>
    </main>

    <!-- INPUT MODAL -->
    <div id="node-modal" class="modal-overlay">
        <div class="modal">
            <h2 id="modal-title" style="font-family: 'Orbitron'; color: var(--cyan); font-size: 16px;">Node Input</h2>
            <label>Date & Time</label>
            <input type="datetime-local" id="log-date">
            <label>What is happening here?</label>
            <textarea id="log-text" rows="4"></textarea>
            <button class="btn btn-save" onclick="saveLog()">Save to Audit</button>
            <button class="btn btn-cancel" onclick="closeModal()">Dismiss</button>
        </div>
    </div>

    <nav>
        <button class="nav-item active" onclick="showScreen('hq', this)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
            <span>Mind HQ</span>
        </button>
        <button class="nav-item" onclick="showScreen('archive', this)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            <span>Archive</span>
        </button>
        <button class="nav-item" onclick="showScreen('audit', this)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
            <span>Audit</span>
        </button>
    </nav>

    <script>
        let activeNode = "";
        let auditData = JSON.parse(localStorage.getItem('mindhq_audit')) || [];

        // App Navigation
        function showScreen(id, btn) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('screen-' + id).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            btn.classList.add('active');
            if(id === 'audit') renderAudit();
            if(id === 'archive') loadArchive();
        }

        // Brain Interaction
        function toggleBrain() {
            const brain = document.getElementById('brain-map');
            brain.classList.toggle('active');
        }

        // Modal Logic
        function openNode(nodeName) {
            activeNode = nodeName;
            document.getElementById('modal-title').innerText = nodeName;
            document.getElementById('log-text').value = "";
            
            // Set current time
            const now = new Date();
            now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
            document.getElementById('log-date').value = now.toISOString().slice(0, 16);
            
            document.getElementById('node-modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('node-modal').style.display = 'none';
        }

        // Data Management
        function saveLog() {
            const text = document.getElementById('log-text').value;
            const date = document.getElementById('log-date').value;
            if(!text) return;

            const entry = {
                id: Date.now(),
                node: activeNode,
                text: text,
                time: date
            };

            auditData.unshift(entry);
            localStorage.setItem('mindhq_audit', JSON.stringify(auditData));

            if(activeNode.includes("Reception")) {
                document.getElementById('alert-msg').innerText = "John, checking The Archive... Is this a Fact or an Opinion? Do not send this to Management yet.";
                document.getElementById('triage-alert').style.display = "block";
            }

            closeModal();
            renderAudit();
        }

        function closeAlert() {
            document.getElementById('triage-alert').style.display = "none";
        }

        function renderAudit() {
            const list = document.getElementById('audit-list');
            list.innerHTML = auditData.length ? "" : "<p style='text-align:center; color:var(--text-dim)'>No data logged for this period.</p>";
            
            auditData.forEach(item => {
                const card = document.createElement('div');
                card.className = 'audit-card';
                card.innerHTML = `
                    <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-size:10px; font-family:'Orbitron'">
                        <span style="color:var(--cyan)">${item.node}</span>
                        <span style="color:var(--text-dim)">${new Date(item.time).toLocaleString()}</span>
                    </div>
                    <div style="font-size:14px; line-height:1.4">${item.text}</div>
                `;
                list.appendChild(card);
            });
        }

        function clearAudit() {
            if(confirm("Purge all triage history?")) {
                auditData = [];
                localStorage.setItem('mindhq_audit', JSON.stringify(auditData));
                renderAudit();
            }
        }

        function saveArchive() {
            const archive = {
                traits: document.getElementById('arc-traits').value,
                history: document.getElementById('arc-history').value,
                triggers: document.getElementById('arc-triggers').value
            };
            localStorage.setItem('mindhq_archive', JSON.stringify(archive));
            alert("Archive persistence confirmed.");
        }

        function loadArchive() {
            const archive = JSON.parse(localStorage.getItem('mindhq_archive'));
            if(archive) {
                document.getElementById('arc-traits').value = archive.traits || "";
                document.getElementById('arc-history').value = archive.history || "";
                document.getElementById('arc-triggers').value = archive.triggers || "";
            }
        }

        // Init
        window.onload = loadArchive;
    </script>
</body>
</html>
